title: 371. 两整数之和

date: 2020-10-04 12:40:12

categories: 2020年10月

tags: [Leetcode, Bit Manipulation]

---


不使用运算符 + 和 -，计算两整数a、b之和。

<!-- more -->



示例 1:
    
    输入: a = 1, b = 2
    输出: 3
示例 2:
    
    输入: a = -2, b = 3
    输出: 1

# 利用位操作实现加法

首先看十进制是如何做的： 5+7=12，三步走 

- 第一步：相加各位的值，不算进位，得到2。 
- 第二步：计算进位值，得到10. 如果这一步的进位值为0，那么第一步得到的值就是最终结果。  
- 第三步：重复上述两步，只是相加的值变成上述两步的得到的结果2和10，得到12。 

同样我们可以用三步走的方式计算二进制值相加： 5---101，7---111 

- 第一步：相加各位的值，不算进位，得到010，**二进制每位相加就相当于各位做异或操作**，101^111。 
- 第二步：计算进位值，得到1010，**相当于各位进行与操作得到101，再向左移一位得到1010**，(101&111)<<1。  
- 第三步重复上述两步，各位相加 010^1010=1000，进位值为100=(010 & 1010)<<1。 
- 继续重复上述两步：1000^100 = 1100，进位值为0，跳出循环，1100为最终结果。 
- 结束条件：**进位为0，即a为最终的求和结果。**
<details>
    <summary>利用位操作实现加法</summary>

```java []
class Solution {
    public int getSum(int a, int b) {
        while(b != 0){
            int temp = a ^ b;
            b = (a & b) << 1;
            a = temp;
        }
        return a;
    }
}
```
</details>


回顾一下我们小学就开始学习的十进制的加法，比如`15+7`，最低位`5+7`得到`12`，对`10`取模得到`2`，进位为`1`，再高位相加`1+0`再加上进位`1`就得到高位结果`2`,组合起来就是`22`。这里面涉及到了两个数字，一个是相加得到的低位，也就是`5+7`得到的结果`2`，第二个是进位`1`。在二进制的计算中就是要通过位操作来得到结果的低位和进位，对于不同的情况，用表格来表示一下，两个数字分别为`a`和`b`

a | b | 低位 | 进位
:-:|:-:|:-:|:-:
0 | 0 | 0 | 0
1 | 0 | 1 | 0
0 | 1 | 1 | 0
1 | 1 | 0 | 1

从上面的表格就可以发现，`低位 = a^b`，`进位 = a & b`。这样的计算可能要持续多次，回想一下在十进制的计算中，如果进位一直大于0，就得往后面进行计算，在这里也是一样，只要进位不是0，我们就得一直重复计算低位和进位的操作（需要在下一次计算之前要把进位向左移动一位，这样进位才能和更高位进行运算）。这个时候的`a`和`b`就是刚才计算的低位和进位，用简单的加法迭代的代码表示：
<details>
    <summary>利用位操作实现加法</summary>

```java
public int getSum(int a, int b) {
    if (a==0) return b;
    if (b==0) return a;
    int lower;
    int carrier;
    while (true) {
        lower = a^b;    // 计算低位
        carrier = a&b;  // 计算进位
        if (carrier==0) break;
        a = lower;
        b = carrier<<1;
    }
    return lower;
}
```
</details>